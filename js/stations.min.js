function compare(e,t){return e.p>t.p?-1:e.p<t.p?1:0}function toggleBtn(e){e?scanStatus.classList.add("show-loading"):scanStatus.classList.remove("show-loading")}function getResults(){getResponse("ClientScanResults.json",function(e){try{res=JSON.parse(e)}catch(e){return void showMessage("ERROR: Clear the client list.")}res.clients=res.clients.sort(compare),clientsFound.innerHTML="("+res.clients.length+" clients found)";t="";res.clients.length>0&&(t+='<tr><th>Name</th><th>Client info</th><th>Pkts</th><th style="padding-left: 40px"></th></tr>');for(s=0;s<res.clients.length;s++)1==res.clients[s].s?t+='<tr class="selected">':t+="<tr>",res.clients[s].n?t+='<td onclick="changeName('+res.clients[s].i+')"><b>'+res.clients[s].n+"</b></td>":t+='<td onclick="changeName('+res.clients[s].i+')">'+res.clients[s].v+"</td>",t+='<td onclick="select('+res.clients[s].i+')"><b>'+res.clients[s].m+"</b><br>"+res.clients[s].a+"</td>",t+='<td onclick="select('+res.clients[s].i+')">'+res.clients[s].p+"</td>",1==res.clients[s].s?t+='<td onclick="select('+res.clients[s].i+')"><input type="checkbox" name="check'+res.clients[s].i+'" id="check'+res.clients[s].i+'" value="false" checked><label class="checkbox no-events" for="check'+res.clients[s].i+'"></label></td>':t+='<td onclick="select('+res.clients[s].i+')"><input type="checkbox" name="check'+res.clients[s].i+'" id="check'+res.clients[s].i+'" value="false"><label class="checkbox no-events" for="check'+res.clients[s].i+'"></label></td>',t+="</tr>";table.innerHTML=t,clientNames.innerHTML="("+res.nameList.length+"/50)";for(var t="<tr><th>Name</th><th>Action</th></tr>",s=0;s<res.nameList.length;s++)t+="<tr>",t+="<td><b>"+res.nameList[s].n+"</b><br>"+res.nameList[s].m+"</td>",t+='<td><div class="edit delete" onclick="deleteName('+s+')">&times;</div><div class="edit add" onclick="add('+s+')">+</div><div class="edit" onclick="changeName('+s+')"><img src="'+edit+'"></div></td>',t+="</tr>";nameListTable.innerHTML=t},function(){showMessage("Reconnect and reload this page"),checkConnection()},3e3)}function checkConnection(){getResponse("ClientScanTime.json",function(e){e&&location.reload()}),setTimeout(checkConnection,2e3)}function scan(){toggleBtn(!0),getResponse("ClientScan.json?time="+scanTime.value,function(e){"true"==e?setTimeout(function(){toggleBtn(!0),getResults()},1e3*scanTime.value):(showMessage("INFO: No Wi-Fi network(s) selected!'"),scanStatus.classList.remove("show-loading"))})}function select(e){getResponse("clientSelect.json?num="+e,function(e){"true"==e?getResults():showMessage("ERROR: Bad response 'clientSelect.json'")})}function clearNameList(){getResponse("clearNameList.json",function(e){"true"==e?getResults():showMessage("ERROR: Bad response 'clearNameList.json'")})}function addClient(){getResponse("addClient.json?mac="+cMac.value+"&name="+cName.value,function(e){"true"==e?getResults():showMessage("ERROR: Bad response 'addClient.json'")})}function changeName(e){var t=prompt("Name for "+res.nameList[e].m);null!=t&&getResponse("editNameList.json?id="+e+"&name="+t,function(e){"true"==e?getResults():document.getElementById("mytext").value="My value"})}function deleteName(e){getResponse("deleteName.json?num="+e,function(e){"true"==e?getResults():showMessage("ERROR: Bad response 'deleteName.json'")})}function add(e){getResponse("addClientFromList.json?num="+e,function(e){"true"==e?getResults():showMessage("ERROR: Bad response 'addClientFromList.json'")})}var table=document.getElementsByTagName("table")[0],scanBtn=getE("startScan"),scanTime=getE("scanTime"),clientsFound=getE("clientsFound"),scanStatus=getE("spinner-container"),clientNames=getE("clientNames"),nameListTable=getE("nameList"),res,edit="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUAgMAAADw5/WeAAAADFBMVEUAAAAAAAAAAAAAAAA16TeWAAAABHRSTlMB/phhN1gO+QAAADtJREFUeF5jQAM8YFIVTIo6AAkm1gIgyenYABIOAAlPjQAJhyaAhEPBwmFowrxgYU6wMGcEiOTbgGYPAPKdCT6Ht/q3AAAAAElFTkSuQmCC";getResponse("ClientScanTime.json",function(e){scanTime.value=e}),getResults(),toggleBtn(!1);